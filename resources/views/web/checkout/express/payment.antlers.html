<!-- TODO: Refactor to vue component maybe? -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://js.braintreegateway.com/web/dropin/1.8.1/js/dropin.min.js"></script>

<div class="butik-mx-5">
    <div class="butik-flex butik-justify-around">
        <a href="{{ express_delivery_url }}" class="butik-block butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-green-500 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">1</div>
            <span class="butik-text-green-500 butik-mt-1">Delivery</span>
        </a>
        <div class="butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-green-500 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">2</div>
            <span class="butik-text-green-500 butik-mt-1">Review & Payment</span>
        </div>
        <div class="butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-gray-400 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">3</div>
            <span class="butik-text-gray-500 butik-mt-1">Receipt</span>
        </div>
    </div>
</div>

<hr class="butik-mb-5 butik-mt-8">

<h1 class="butik-block butik-mb-6 butik-text-center butik-font-bold butik-text-xl">Express Checkout</h1>

<div class="butik-flex butik-flex-col-reverse lg:butik-flex-row butik-px-5 lg:butik-px-0  butik-mb-20 butik-mt-6">
    <div class="butik-w-full lg:butik-ml-5 lg:butik-px-0 lg:butik-w-1/2 xl:butik-ml-0">

        <div class="butik-bordeer butik-border butik-border-gray-500 butik-px-6 butik-py-3 butik-mt-8 lg:butik-mt-0 butik-rounded-md">
            <h3 class="butik-font-bold">Ship to</h3>
            <div>{{ name }}</div>
            <div class="butik-mb-2">{{ mail }}</div>

            <div>{{ address_1 }}</div>
            {{if address_2 }}
                <div>{{ address_2 }}</div>
            {{ /if }}
            <div>{{ city }}</div>
            <div>{{ zip }}</div>
            <div>{{ country }}</div>
        </div>

        <div id="dropin-container" style="min-height: 200px;"></div>
        <button id="submit-button" class="butik-block butik-w-full butik-mt-3 butik-bg-gray-900 butik-mt-6 butik-py-2 butik-rounded butik-text-center butik-text-white butik-text-xl hover:butik-bg-gray-800">
            Pay now & confirm
        </button>
        <script>
            var button = document.querySelector('#submit-button');

            braintree.dropin.create({
                authorization: 'sandbox_8hc4ttnw_8t2hkkd3nn7yqncp',
                container: '#dropin-container'
            }, function (createErr, instance) {
                button.addEventListener('click', function () {
                    instance.requestPaymentMethod(function (requestPaymentMethodErr, payload) {
                        $.get('{{ braintree:route name="payment.process" }}', {payload}, function (response) {
                            if (response.success) {
                                alert('Payment successfull!');
                            } else {
                                alert('Payment failed');
                            }
                        }, 'json');
                    });
                });
            });
        </script>
    </div>


    <div class="butik-flex butik-items-center lg:butik-pl-10 butik-w-full lg:butik-w-1/2">
        <div class="butik-bg-gray-200 butik-rounded butik-py-6 lg:butik-py-12">
            <div class="butik-flex butik-justify-center butik-mt-5">
                {{ images limit="1" }}
                <img class="butik-w-2/5 butik-rounded" src="/assets/{{ value }}">
                {{ /images }}
            </div>

            <section class="butik-px-10">
                <h3 class="butik-font-bold butik-block butik-mt-5 butik-text-3xl butik-text-center">{{ title }}</h3>

                <hr class="butik-border-white butik-my-5">

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>Subtotal</span>
                    <span>{{ butik:currency_symbol }} {{ base_price }}</span>
                </div>

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>Shipping</span>
                    <span>{{ butik:currency_symbol }} 5,00</span>
                </div>

                <hr class="butik-border-white butik-my-5">

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>Total</span>
                    <span class="butik-font-black">{{ butik:currency_symbol }} 1402,00</span>
                </div>

            </section>
        </div>
    </div>
</div>



