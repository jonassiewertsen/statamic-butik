{{# <!-- TODO: Remember to refactor. It looks like ... -->  #}}
{{# Dont worry. These two sections wont be rendered into HTML.  #}}

<div class="butik-mx-5">
    <div class="butik-flex butik-justify-around">
        <a href="{{ express_delivery_url }}" class="butik-block butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-green-500 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">1</div>
            <span class="butik-text-green-500 butik-mt-1">{{ trans key="statamic-butik::payment.delivery" }}</span>
        </a>
        <div class="butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-green-500 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">2</div>
            <span class="butik-text-green-500 butik-mt-1">{{ trans key="statamic-butik::payment.review_payment" }}</span>
        </div>
        <div class="butik-text-xs butik-flex butik-flex-col butik-items-center">
            <div class="butik-border-2 butik-border-gray-400 butik-flex butik-h-8 butik-items-center butik-justify-center butik-rounded-full butik-w-8">3</div>
            <span class="butik-text-gray-500 butik-mt-1">{{ trans key="statamic-butik::payment.receipt" }}</span>
        </div>
    </div>
</div>

<hr class="butik-mb-5 butik-mt-8">

<h1 class="butik-block butik-mb-6 butik-text-center butik-font-bold butik-text-xl">{{ trans key="statamic-butik::payment.express_checkout" }}</h1>

<div class="butik-flex butik-flex-col-reverse lg:butik-flex-row butik-px-5 lg:butik-px-0  butik-mb-20 butik-mt-6">
    <div class="butik-w-full lg:butik-ml-5 lg:butik-px-0 lg:butik-w-1/2 xl:butik-ml-0">

        <div class="butik-bordeer butik-border butik-border-gray-500 butik-px-6 butik-py-3 butik-mt-8 lg:butik-mt-0 butik-rounded-md">
            <h3 class="butik-underline">{{ trans key="statamic-butik::payment.ship_to" }}</h3>
            <div>
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.name" }}</span>
                <span>{{ name }}</span>
            </div>
            <div class="butik-mb-2">
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.mail" }}</span>
                <span>{{ mail }}</span>
            </div>

            <div>
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.address_1" }}</span>
                <span>{{ address_1 }}</div>
            {{if address_2 }}
                <div>
                    <span class="butik-font-bold">{{ trans key="statamic-butik::payment.address_2" }}</span>
                    <span>{{ address_2 }}</span>
                </div>
            {{ /if }}
            <div>
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.city" }}</span>
                <span>{{ city }}</span>
            </div>
            <div>
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.zip" }}</span>
                <span>{{ zip }}</span>
            </div>
            <div>
                <span class="butik-font-bold">{{ trans key="statamic-butik::payment.country" }}</span>
                <span>{{ country }}</span>
            </div>
        </div>

        <div id="dropin-container" class="butik-mt-3" style="min-height: 200px;"></div>
        <button id="submit-button" class="butik-block butik-w-full butik-mt-3 butik-bg-gray-900 butik-mt-6 butik-py-2 butik-rounded butik-text-center butik-text-white butik-text-xl hover:butik-bg-gray-800">
            {{ trans key="statamic-butik::payment.pay_now" }}
        </button>
        <script>
            var button = document.querySelector('#submit-button');
            // TODO: Prepare PayPal but dont ship it as default
            braintree.dropin.create({
                authorization: 'sandbox_8hc4ttnw_8t2hkkd3nn7yqncp',
                container: '#dropin-container',
                locale: '{{ site_locale }}',
                paypal: {
                    flow: 'vault',
                },
                card: {
                    cardholderName: {
                        required: true,
                    }
                }
            }, function (createErr, instance) {
                button.addEventListener('click', function () {
                    instance.requestPaymentMethod(function (requestPaymentMethodErr, payload) {
                        $.get('{{ braintree:route name="payment.process" }}', {payload}, function (response) {
                            if (response.success) {
                                // TODO: add redirect dynamically
                                window.location.href = "/shop/express-checkout/receipt/nort-jaime-2020";
                            } else {
                                instance.clearSelectedPaymentMethod();

                                alert('{{ trans key="statamic-butik::payment.process_failed" }}.\n\n' +
                                    '{{ trans key="statamic-butik::payment.error_message" }}\n ' +
                                    response.message);
                            }
                        }, 'json');
                    });
                });
            });
        </script>
    </div>


    <div class="butik-flex butik-items-center lg:butik-pl-10 butik-w-full lg:butik-w-1/2">
        <div class="butik-bg-gray-200 butik-rounded butik-py-6 lg:butik-py-12">
            <div class="butik-flex butik-justify-center butik-mt-5">
                {{ images limit="1" }}
                <img class="butik-w-2/5 butik-rounded" src="/assets/{{ value }}">
                {{ /images }}
            </div>

            <section class="butik-px-10">
                <h3 class="butik-font-bold butik-block butik-mt-5 butik-text-3xl butik-text-center">{{ title }}</h3>

                <hr class="butik-border-white butik-my-5">

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>{{ trans key="statamic-butik::payment.subtotal" }}</span>
                    <span>{{ butik:currency_symbol }} {{ base_price }}</span>
                </div>

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>{{ trans key="statamic-butik::payment.shipping" }}</span>
                    <span>{{ butik:currency_symbol }} 5,00</span>
                </div>

                <hr class="butik-border-white butik-my-5">

                <div class="butik-flex butik-my-3 butik-justify-between butik-max-w-sm butik-mx-auto">
                    <span>{{ trans key="statamic-butik::payment.total" }}</span>
                    <span class="butik-font-black">{{ butik:currency_symbol }} 1402,00</span>
                </div>

            </section>
        </div>
    </div>
</div>



